
Printing Part 1: Sessionizing IP addresses
+------------------------------------------+---------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+----------+
|15_min_window                             |ip_address     |time_stamp                |url                                                                                                                                                                                                     |count|session_id|
+------------------------------------------+---------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+----------+
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|106.51.141.73  |2015-07-21 22:44:55.088828|https://paytm.com:443/shop/h/electronics?utm_source=Affiliates&utm_medium=VCOMM&utm_campaign=VCOMM-generic&utm_term=24890                                                                               |1    |217       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|107.167.109.115|2015-07-21 22:43:42.690696|http://www.paytm.com:80/                                                                                                                                                                                |1    |211       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|113.193.203.163|2015-07-21 22:41:04.498964|https://paytm.com:443/paytmwallet?utm_medium=promocodeclub&utm_source=affiliate&utm_campaign=promocodeclub                                                                                              |1    |205       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|115.184.19.68  |2015-07-21 22:43:17.055365|https://paytm.com:443/                                                                                                                                                                                  |1    |209       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|115.250.103.3  |2015-07-21 22:44:29.783466|https://paytm.com:443/settings                                                                                                                                                                          |3    |215       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|115.250.103.3  |2015-07-21 22:44:36.934075|https://paytm.com:443/styles/app.css                                                                                                                                                                    |3    |215       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|115.250.103.3  |2015-07-21 22:44:42.024427|https://paytm.com:443/login                                                                                                                                                                             |3    |215       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|116.203.129.121|2015-07-21 22:43:51.141393|https://paytm.com:443/                                                                                                                                                                                  |5    |212       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|116.203.129.121|2015-07-21 22:43:51.993829|https://paytm.com:443/                                                                                                                                                                                  |5    |212       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|116.203.129.121|2015-07-21 22:43:52.52651 |https://www.paytm.com:443/                                                                                                                                                                              |5    |212       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|116.203.129.121|2015-07-21 22:43:52.947822|https://paytm.com:443/                                                                                                                                                                                  |5    |212       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|116.203.129.121|2015-07-21 22:43:58.7724  |https://paytm.com:443/shop/cart?channel=web&version=2                                                                                                                                                   |5    |212       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.198.45.19  |2015-07-21 22:44:07.341879|https://paytm.com:443/papi/nps/merchantrating?merchant_id=23789&channel=web&version=2                                                                                                                   |3    |213       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.198.45.19  |2015-07-21 22:44:07.363787|https://paytm.com:443/papi/v1/promosearch/product/5396457/offers?parent_id=5396470&price=1455&channel=web&version=2                                                                                     |3    |213       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.198.45.19  |2015-07-21 22:44:07.448925|https://paytm.com:443/papi/rr/products/5396457/statistics?channel=web&version=2                                                                                                                         |3    |213       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.199.132.124|2015-07-21 22:43:21.630984|https://paytm.com:443/shop/g/home-kitchen/the-home-store/just-linen-raymond-spaces-extra-50-off?utm_source=affiliate&utm_medium=innovativelead&utm_campaign=innovativelead-generic&utm_term=affiliate-id|1    |210       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.253.213.104|2015-07-21 22:43:14.338766|https://paytm.com:443/shop?utm_source=Affiliates&utm_medium=VCOMM&utm_campaign=VCOMM&utm_term=24890                                                                                                     |2    |208       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|117.253.213.104|2015-07-21 22:44:54.852518|https://paytm.com:443/shop/cart?channel=web&version=2                                                                                                                                                   |2    |208       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|120.60.191.85  |2015-07-21 22:41:01.441071|http://paytm.com:80/?gclid=CNvGq5zb7cYCFRMDvAodCU4P8w                                                                                                                                                   |5    |204       |
|[2015-07-21 22:30:00, 2015-07-21 22:45:00]|120.60.191.85  |2015-07-21 22:41:01.937374|https://paytm.com:443/?gclid=CNvGq5zb7cYCFRMDvAodCU4P8w                                                                                                                                                 |5    |204       |
+------------------------------------------+---------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+----------+
only showing top 20 rows

Printing PART 2: Session duration of each IP address/User
+----------+--------------------------+------------------------------------------+--------------+--------------------------+--------------------------------------------------------------------------------------------------------------------+-----+---------------+----------------+
|session_id|first_visit_time_stamp    |15_min_window                             |ip_address    |time_stamp                |url                                                                                                                 |count|time_difference|session_duration|
+----------+--------------------------+------------------------------------------+--------------+--------------------------+--------------------------------------------------------------------------------------------------------------------+-----+---------------+----------------+
|26        |2015-07-22 05:02:20.711268|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|218.248.82.9  |2015-07-22 05:02:20.711268|https://paytm.com:443/checkout                                                                                      |4    |0              |13              |
|26        |2015-07-22 05:02:20.711268|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|218.248.82.9  |2015-07-22 05:02:23.534997|http://www.paytm.com:80/                                                                                            |4    |3              |13              |
|26        |2015-07-22 05:02:20.711268|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|218.248.82.9  |2015-07-22 05:02:28.536063|http://www.paytm.com:80/                                                                                            |4    |8              |13              |
|26        |2015-07-22 05:02:20.711268|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|218.248.82.9  |2015-07-22 05:02:33.005753|https://paytm.com:443/checkout                                                                                      |4    |13             |13              |
|29        |2015-07-22 05:02:32.186441|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|27.62.30.188  |2015-07-22 05:02:32.186441|https://paytm.com:443/logout                                                                                        |4    |0              |33              |
|29        |2015-07-22 05:02:32.186441|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|27.62.30.188  |2015-07-22 05:02:36.228038|https://paytm.com:443/                                                                                              |4    |4              |33              |
|29        |2015-07-22 05:02:32.186441|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|27.62.30.188  |2015-07-22 05:02:51.727269|https://paytm.com:443/settings                                                                                      |4    |19             |33              |
|29        |2015-07-22 05:02:32.186441|[2015-07-22 05:00:00, 2015-07-22 05:15:00]|27.62.30.188  |2015-07-22 05:03:05.708982|https://paytm.com:443/login                                                                                         |4    |33             |33              |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:33.695588|https://paytm.com:443/papi/nps/merchantrating?merchant_id=50907&channel=web&version=2                               |20   |0              |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:33.710601|https://paytm.com:443/papi/v1/promosearch/product/14840499/offers?parent_id=14840500&price=320&channel=web&version=2|20   |0              |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:33.735565|https://paytm.com:443/papi/rr/products/14840499/statistics?channel=web&version=2                                    |20   |0              |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:47.523263|https://paytm.com:443/papi/nps/merchantrating?merchant_id=50907&channel=web&version=2                               |20   |14             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:47.53199 |https://paytm.com:443/papi/v1/promosearch/product/14840499/offers?parent_id=14840500&price=320&channel=web&version=2|20   |14             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:35:47.559858|https://paytm.com:443/papi/rr/products/14840499/statistics?channel=web&version=2                                    |20   |14             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:36:34.74762 |https://paytm.com:443/shop/orderdetail/1091202652?actions=1&channel=web&version=2                                   |20   |61             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:36:34.929474|https://paytm.com:443/papi/nps/merchantverification                                                                 |20   |61             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:36:46.108213|https://paytm.com:443/shop/labels?vertical_id=43&item_status=17&channel=web&details=1&version=2                     |20   |73             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:36:46.160956|https://paytm.com:443/shop/orderdetail/1091202652?actions=1&channel=web&version=2                                   |20   |73             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:37:10.596234|https://paytm.com:443/shop/orderdetail/1091202652?actions=1&channel=web&version=2                                   |20   |97             |226             |
|474       |2015-07-22 06:35:33.695588|[2015-07-22 06:30:00, 2015-07-22 06:45:00]|101.221.128.95|2015-07-22 06:37:10.786066|https://paytm.com:443/papi/nps/merchantverification                                                                 |20   |97             |226             |
+----------+--------------------------+------------------------------------------+--------------+--------------------------+--------------------------------------------------------------------------------------------------------------------+-----+---------------+----------------+
only showing top 20 rows

Printing PART 3: How many URLs did each user/IP hit?
+----------+--------------------------------------------------------------------------------------------------------------------+-----+
|session_id|URL                                                                                                                 |count|
+----------+--------------------------------------------------------------------------------------------------------------------+-----+
|26        |https://paytm.com:443/checkout                                                                                      |2    |
|26        |http://www.paytm.com:80/                                                                                            |2    |
|29        |https://paytm.com:443/logout                                                                                        |1    |
|29        |https://paytm.com:443/                                                                                              |1    |
|29        |https://paytm.com:443/settings                                                                                      |1    |
|29        |https://paytm.com:443/login                                                                                         |1    |
|474       |https://paytm.com:443/papi/nps/merchantrating?merchant_id=50907&channel=web&version=2                               |2    |
|474       |https://paytm.com:443/papi/v1/promosearch/product/14840499/offers?parent_id=14840500&price=320&channel=web&version=2|2    |
|474       |https://paytm.com:443/papi/rr/products/14840499/statistics?channel=web&version=2                                    |2    |
|474       |https://paytm.com:443/shop/orderdetail/1091202652?actions=1&channel=web&version=2                                   |5    |
|474       |https://paytm.com:443/papi/nps/merchantverification                                                                 |3    |
|474       |https://paytm.com:443/shop/labels?vertical_id=43&item_status=17&channel=web&details=1&version=2                     |2    |
|474       |https://paytm.com:443/shop/orderhistory?pagesize=10&channel=web&version=2                                           |1    |
|474       |https://paytm.com:443/shop/myorders/1091202652                                                                      |1    |
|474       |https://paytm.com:443/myorders/1091202652                                                                           |1    |
|474       |https://paytm.com:443/shop/cart?channel=web&version=2                                                               |1    |
|8589934658|https://paytm.com:443/                                                                                              |1    |
|8589934965|https://paytm.com:443/shop/h/electronics?utm_term=1                                                                 |1    |
|8589934965|https://paytm.com:443/favicon.ico                                                                                   |1    |
|8589935171|https://paytm.com:443/shop/cart                                                                                     |1    |
+----------+--------------------------------------------------------------------------------------------------------------------+-----+
only showing top 20 rows

printing PART 4: Users with the most session duration (browsing time)
+---------------+-------------+----------------+
|ip_address     |session_id   |session_duration|
+---------------+-------------+----------------+
|164.100.96.254 |249108103236 |847             |
|111.119.199.22 |283467841590 |839             |
|117.220.186.227|755914244158 |804             |
|15.211.153.75  |17179869239  |596             |
|119.235.53.134 |197568495681 |594             |
|116.50.79.74   |1606317769130|579             |
|52.74.219.71   |1417339208087|559             |
|103.36.251.10  |1279900254642|559             |
|106.186.23.95  |1159641170327|559             |
|14.139.85.180  |1039382086048|558             |
|1.39.62.168    |1365799600574|558             |
|202.9.75.75    |747324309920 |558             |
|119.81.61.166  |1039382086046|558             |
|103.29.159.186 |1486058684784|558             |
|182.66.36.72   |807453852036 |557             |
|125.19.44.66   |352187318677 |557             |
|54.251.151.39  |146028888488 |557             |
|122.15.156.64  |429496730003 |557             |
|188.40.135.194 |876173328818 |557             |
|203.191.34.178 |1486058684787|556             |
+---------------+-------------+----------------+
only showing top 20 rows
